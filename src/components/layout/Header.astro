---
import Container from '../ui/Container.astro';

const {
  brandLabel = '',
  brandHref = '/',
  navItems = [],
  currentPath = '',
  sticky = false,
} = Astro.props;

const hasBrandSlot = Astro.slots.has('brand');
const hasCustomNav = Astro.slots.has('default');
const hasActions = Astro.slots.has('actions');
---

<header class:list={['site-header', sticky && 'site-header--sticky']}>
  <Container size="wide" class="site-header__inner">
    <div class="site-header__brand">
      {hasBrandSlot ? (
        <slot name="brand" />
      ) : brandLabel ? (
        <a class="site-header__brand-link" href={brandHref}>{brandLabel}</a>
      ) : null}
    </div>

    {(hasCustomNav || navItems.length > 0) && (
      <nav class="site-header__nav" aria-label="Primary">
        {hasCustomNav ? (
          <slot />
        ) : (
          <ul class="site-header__list">
            {navItems.map((item) => (
              <li>
                <a
                  class="site-header__link"
                  href={item.href}
                  aria-current={currentPath === item.href ? 'page' : undefined}
                >
                  {item.label}
                </a>
              </li>
            ))}
          </ul>
        )}
      </nav>
    )}

    {hasActions && (
      <div class="site-header__actions">
        <slot name="actions" />
      </div>
    )}
  </Container>
</header>

<style>
  .site-header {
    border-bottom: var(--border-thin);
    background: rgba(255, 249, 251, 0.82);
    backdrop-filter: blur(16px);
  }

  .site-header--sticky {
    position: sticky;
    top: 0;
    z-index: 20;
  }

  .site-header__inner {
    display: grid;
    grid-template-columns: auto minmax(0, 1fr) auto;
    align-items: center;
    gap: var(--space-4);
    min-height: 4.75rem;
    padding-block: var(--space-3);
  }

  .site-header__brand-link {
    font-family: var(--font-ui);
    font-size: var(--step-1);
    font-weight: 600;
    text-decoration: none;
    white-space: nowrap;
  }

  .site-header__nav {
    justify-self: end;
  }

  .site-header__list {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: flex-end;
    gap: var(--space-2);
    padding: 0;
    margin: 0;
    list-style: none;
  }

  .site-header__link {
    display: inline-flex;
    align-items: center;
    min-height: 2.25rem;
    padding: 0.4rem 0.8rem;
    border-radius: var(--radius-pill);
    color: var(--color-text-secondary);
    font-family: var(--font-ui);
    font-size: var(--step--1);
    font-weight: 600;
    text-decoration: none;
    transition:
      color var(--transition-soft),
      background-color var(--transition-soft);
  }

  .site-header__link:hover,
  .site-header__link:focus-visible {
    color: var(--color-text-primary);
    background: rgba(249, 238, 244, 0.85);
  }

  .site-header__link[aria-current='page'] {
    color: var(--color-text-primary);
    background: rgba(243, 238, 248, 0.9);
  }

  .site-header__actions {
    display: flex;
    align-items: center;
    justify-self: end;
  }

  @media (max-width: 52rem) {
    .site-header__inner {
      grid-template-columns: 1fr;
      justify-items: start;
    }

    .site-header__nav,
    .site-header__actions {
      justify-self: start;
    }

    .site-header__list {
      justify-content: flex-start;
    }
  }
</style>
